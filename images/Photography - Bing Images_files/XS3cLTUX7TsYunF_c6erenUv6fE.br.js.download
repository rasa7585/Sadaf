var FeedSimilarContent;(function(){function gt(n,t){var r=_qs("img#svd-itm",n),i=_qs("div#clinf #clinf-p a",n);r!==null&&r!==undefined&&(r.src=t,r.alt="img-thmbnl");i!==null&&i!==undefined&&(i.id="collnk",i.href=fi(tt),i.innerText=it)}function ri(n){var i=n[0],t=n[1];t&&(t.bind("ssint",ii,!0),t.bind("ssism",ot,!0),t.bind("cstl",st,!0))}function ht(){clearTimeout(rt)}function ct(){rt=setTimeout(st,bt)}function fi(n){return a?a+"&collId="+n:"#"}var t=FeedConstants,lt=ImageFeedUtils.tryParseJson,p="dgControl_list",e="fetchSimilarImages",at="PrismConsumption",w=110,vt=["fre"],b="fb",yt="onSvCtrlClickFdPg",k="resize",d="unload",o="hd",pt=100,wt=2e3,g={},s,i,n,h=0,c=5,r,nt=!1,l,tt,it,bt=5e3,rt,a,kt=function(n){while(n&&n.parentElement&&!n.parentElement.classList.contains(p))n=n.parentElement;return n},u=function(n,t){n.style.maxHeight=t},f=function(n,t,i){u(t,"0");i?n.insertBefore(t,i):n.appendChild(t);var r=_qs("img.mimg",t);u(t,Math.ceil(r.height/r.width)*n.clientWidth+w+"px")},dt=function(r,u){var f=null;return r==t.triggeredSaveEvent?(f=n.cloneNode(!0),f.classList.add(r),gt(f,u)):(f=i.cloneNode(!0),f.classList.add(r)),f},ni=function(i,r,f,e,h){var c=dt(f,e),a,l,v;if(f==t.triggeredSaveEvent)n&&n.parentElement&&n.parentElement.removeChild(n),n=c,n.classList.remove(o),n.style.width=h-24+"px",n.style.left="calc(50% - ".concat(h/2,"px)"),i.parentElement.insertBefore(n,i),ht(),ct(),sj_be(n,t.mouseEnterEvent,ht),sj_be(n,t.mouseLeaveEvent,ct);else{if(a=_qs(".txt",c),l=_qs(".fdsm-txt",c),!a||!l)return;f==b&&(s=c);a.textContent=a.dataset[f];v=f==="save"?l.innerHTML.replace(/&lt;/g,"<").replace(/&gt;/g,">"):l.dataset[f];l.innerHTML=ft(v);u(c,"0");i.insertBefore(c,r);sb_st(function(){u(c,w+"px")},100)}},ut=function(n,t,i){var e=r[t-1],u=e.childNodes,h,o,s;if(!(u.length<=0)){for(h=function(t){var r=u[t];if(r.getBoundingClientRect().bottom>i)return vt.find(function(n){return r.classList.contains(n)})?f(e,n,t<u.length-1?u[t+1]:null):f(e,n,r),{value:void 0}},o=0;o<u.length;o++)if(s=h(o),typeof s=="object")return s.value;e.appendChild(n)}},ti=function(u,e,o,s,h,c){var a,y;if(e){var l=null,v=h==t.triggeredSaveEvent&&n!=null,p=h==t.triggeredLikeEvent&&i!=null&&!g[h];u&&u.length>0&&(l=u.pop(),e.nextSibling?f(o,l,e.nextSibling):f(o,l),a=e.getBoundingClientRect().bottom,s>1&&u.length>0&&ut(u.pop(),s-1,a),s<r.length&&u.length>0&&ut(u.pop(),s+1,a));(p&&l||v)&&(y=v?pt:wt,g[h]=!0,sb_st(function(){ni(o,l,h,c,e.offsetWidth)},y))}},v=function(t){var s,g=t[0],p=t[1],w=t[2],v=t[3],f,e;if(p&&w&&v&&(f=lt(p),f&&f.id&&f.type!=1)&&(e=kt(w),e&&e.parentElement&&!e.classList.contains("clst-rndrd"))){var o=e.parentElement,y=+((s=o===null||o===void 0?void 0:o.dataset)===null||s===void 0?void 0:s.col),k=y==0||y==r.length?2:3,d=encodeURIComponent(f.id),u=sj_gx();u.open("GET","".concat(l,"&itemId=").concat(d,"&count=").concat(k,"&source=").concat(at,"&IG=").concat(_G.IG,"&IID=SSI&sfx=").concat(++h,"&tevnt=").concat(v));u.onreadystatechange=function(){var r,t,s;u.status==200&&u.readyState==4&&u.responseText&&(t=_d.createElement("div"),t.innerHTML=ft(u.responseText),h==1&&(n=_qs("div.fdsmtoast",t),a=n?(r=_qs("div#clinf #clinf-p a",n))===null||r===void 0?void 0:r.getAttribute("href"):null,i=_qs("li.fdsmtoast",t),c=+(i===null||i===void 0?void 0:i.dataset.max)),s=Array.prototype.slice.call(t.querySelectorAll("div#fdsim > li.fdsim")),ti(s,e,o,y,c&&h==c?b:v.toLowerCase(),f.turl))};u.timeout=2e3;u.send()}},ft=function(n){return nt?DefaultTrustedTypesPolicy.getOpaqueHTML(n):n},et=function(){sj_evt.unbind(e,v);sj_ue(_w,k,y);sj_ue(_w,d,et)},ii=function(){sj_evt.unbind(e,v);ot()},ot=function(){u(s,"0");sb_st(function(){s.classList.add(o)},550)},st=function(){sb_st(function(){n.classList.add(o)},100)},y=function(){r=_d.querySelectorAll(".".concat(p))},ui=function(n){tt=n[1];it=n[2]},ei=function(){var n;(y(),l=(n=_ge("ssidt"))===null||n===void 0?void 0:n.dataset.ssiurl,!r||r.length<=0||!l)||(sj_evt.bind(e,v),nt=typeof DefaultTrustedTypesPolicy!="undefined",sj_be(_w,k,y),sj_evt.bind("ClientLinkAction_Loaded",ri,!0),sj_be(_w,d,et),sj_evt.bind(yt,ui,!0))};ei()})(FeedSimilarContent||(FeedSimilarContent={}))