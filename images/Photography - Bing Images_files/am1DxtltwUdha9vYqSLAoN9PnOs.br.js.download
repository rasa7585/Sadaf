var ImgFdPage;(function(){function bt(){var r=i===null||i===void 0?void 0:i.getAttribute("data-enrtry"),t;(n.MaxRetryCount=r?parseInt(r):n.MaxRetryCount,t=kt(_ge("defOver"),"data-cfg"),t!=null)&&(e=t.SeenThresholdInMs||e,h=t.viewSeen||h)}function kt(n,t){return o(n===null||n===void 0?void 0:n.getAttribute(t))}function d(){var n={},i=t.getSlice(),u;(t.isSetFeedbackTimeout=!1,i.length<=0)||(i.forEach(function(t){var i=s(t.target);n[t.eventName]?n[t.eventName].push(i):n[t.eventName]=[i];h&&t.target.classList.add("fdsnimgs")}),t.observerQueue=t.observerQueue.filter(function(n){return!n.processed}),u=Object.keys(n),u.forEach(function(t){r(t,n[t])}))}function dt(n){for(var u,r=t.observerQueue,f=!1,i=0;i<=r.length;i++)r[i]&&r[i].isVisible&&!r[i].processed&&(u=r[i].onScreenTime+(performance.now()-r[i].lastVisibleTimestamp),u>=e&&(f=!0,r[i].processed=!0,r[i].onScreenTime=u,r[i].lastVisibleTimestamp=performance.now(),t.enqueueEvent(r[i].target,k(r[i].target)),n.unobserve(r[i].target)));f&&!t.isSetFeedbackTimeout&&g()}function g(){t.isSetFeedbackTimeout=!0;sb_st(d,2e3)}function gt(){c();d();document.hidden&&b&&_w.scrollTo(0,0)}function nt(n,t){return fi(t)?!1:(n.observe(t),typeof a!="undefined"&&a(t),sj_evt.fire(lt,t),!0)}function ni(){for(var r,t=new IntersectionObserver(wt,yt),u=_d.querySelectorAll(w),i=0;i<u.length;i++)t.observe(u[i]);for(r=_d.querySelectorAll(".".concat(n.frevNextItemClass)),i=0;i<r.length;i++)t.observe(r[i]);c=function(){dt(t)};var f=function(i){var r=0,u;i.forEach(function(i){for(var y,e,f,o,s,h,c,l,a,v,u=0;u<i.addedNodes.length;u++){if(y="li[data-idx]",(s=(o=i.addedNodes[u])===null||o===void 0?void 0:o.classList)===null||s===void 0?void 0:s.contains(n.DenseGridClass))for(f=i.addedNodes[u].querySelectorAll(y),e=0;e<f.length;e++)t.observe(f[e]);((c=(h=i.addedNodes[u])===null||h===void 0?void 0:h.classList)===null||c===void 0?void 0:c.contains(n.frevNextItemClass))&&t.observe(i.addedNodes[u]);typeof((l=i.addedNodes[u])===null||l===void 0?void 0:l.getAttribute)!="function"||i.addedNodes[u].getAttribute("data-obsrvd")==="1"||(i.addedNodes[u].tagName==="LI"&&(nt(t,i.addedNodes[u])||(r+=1)),i.addedNodes[u].tagName==="UL"&&((a=i.addedNodes[u].classList)===null||a===void 0?void 0:a.contains(n.DenseGridColClass))&&(f=i.addedNodes[u].querySelectorAll(y),f.forEach(function(n){nt(t,n)||(r+=1)}),(v=i.addedNodes[u].parentNode)===null||v===void 0?void 0:v.removeChild(i.addedNodes[u])))}});u=JSON.stringify({T:"CI.Duplicated",Count:r,TS:sb_gt()});mmLog(u)},e=new MutationObserver(f),o=_ge(n.DenseGridWrapperId)||sj_b;e.observe(o,pt);setInterval(c,ht)}function ti(n){var t=sj_et(n),i=t===null||t===void 0?void 0:t.getAttribute("href");(i===null||i===void 0?void 0:i.indexOf("#CA!"))>=0||t.classList.contains("fdshwless_refrshbtn")||t.tagName==="SOCIAL-BAR-WC"||r("Click",u(t),t)}function ii(){b=!0;sj_evt.unbind(v,tt);sj_evt.unbind(y,it);sj_evt.unbind(p,rt)}function tt(n){var t=n[1];t&&r("save",u(t),t)}function it(n){var t=n[1];t&&r("unsave",u(t))}function rt(n){n.length>1&&n[1]&&n[2]&&r(n[2],u(n[1]))}function ri(){var n=_qs(vt);n&&r("overlayboost",u(n))}function si(){var u,t;for(sj_evt.bind(v,tt,!0),sj_evt.bind(y,it,!0),sj_evt.bind(p,rt),u=_d.querySelectorAll(".infopt"),t=0;t<u.length;t++)sj_be(u[t],st,ui);bt();i!==null&&_qs(n.DenseGridContainerSelector,i)==null&&(r(n.ZeroFeedEvent,[]),i.classList.contains(ct)?(_w.parent[f]=_w.parent[f]?_w.parent[f]+1:1,_w.parent[f]<n.MaxRetryCount&&(n.OnloadEventToCollectionsEnabled=!1,_w.location.reload())):ut(n.ZeroFeedAfterRetryEvent));ni();ri();ei();sj_be(_ge("fd-cont")||sj_b,n.ClickEventName,ti);sj_be(_d,et,gt);sj_be(_w,ot,ii);oi()}var n=FeedConstants,a=_w.fdpln,r=ImageFeedUtils.processRequest,u=ImageFeedUtils.processElement,ut=ImageFeedUtils.refreshWithRetry,o=ImageFeedUtils.tryParseJson,s=ImageFeedUtils.getMetaData,ft=function(){function n(){this.eventsQueue=[];this.observerQueue=[]}return n.prototype.enqueueEvent=function(n,t){var i={target:n,eventName:t};this.eventsQueue.push(i)},n.prototype.enqueueObserver=function(n){var t={target:n,isVisible:!1,lastVisibleTimestamp:0,onScreenTime:0,processed:!1};return this.observerQueue.push(t),t},n.prototype.getObserverEntry=function(n){for(var t=0;t<this.observerQueue.length;t++)if(this.observerQueue[t].target==n)return this.observerQueue[t];return null},n.prototype.getSlice=function(){return this.eventsQueue.splice(0)},n}(),et="visibilitychange",ot="beforeunload",v="Saved",y="Unsaved",st="focusin",p="sbw_react",hi="".concat(n.DenseGridContainerSelector," ").concat(n.DenseGridItemSelector),ht=n.SeenEventRegisterInterval,i=_ge(n.ImageFeedContainerId),ct="edg_rp",f="feedRefreshRetryCount",lt="async_image_load",at="FreSeen",vt=".isbstr",w=".iuscp",b=!1,e=2e3,h=!1,c,l=[],yt={root:null,rootMargin:"0% 0% 5% 0%",threshold:[.7,1]},pt={childList:!0,subtree:!0},t=new ft,k=function(t){var i;return((i=t===null||t===void 0?void 0:t.classList)===null||i===void 0?void 0:i.contains(n.frevNextItemClass))?at:n.SeenEvent},wt=function(n,i){var r=!1;n.forEach(function(n){var u=t.getObserverEntry(n.target),f;u||(u=t.enqueueObserver(n.target));n.intersectionRatio>.4&&n.intersectionRatio<.9&&u.isVisible&&(u.onScreenTime+=n.time-u.lastVisibleTimestamp,u.lastVisibleTimestamp=0,u.isVisible=!1,u.onScreenTime>=e&&!u.processed&&(u.processed=!0,t.enqueueEvent(n.target,k(n.target)),r=!0,i.unobserve(n.target)));n.intersectionRatio==1&&u&&(u.isVisible=!0,u.lastVisibleTimestamp=n.time);f=n.target.querySelectorAll("a, button, input, textarea, select");n.intersectionRatio>=1?f.forEach(function(n){n.removeAttribute("tabindex");n.removeAttribute("aria-hidden")}):f.forEach(function(n){n.setAttribute("tabindex","-1");n.setAttribute("aria-hidden","true")})});r&&!t.isSetFeedbackTimeout&&g()},ui=function(n){sj_sp(n)},fi=function(n){var t,i,r=(t=o(s(n)))===null||t===void 0?void 0:t.id,u;return r?(u=l.indexOf(r)>=0,u?(i=n.parentElement)===null||i===void 0?void 0:i.removeChild(n):l.push(r),u):!1},ei=function(){for(var r,n,i=_d.querySelectorAll(w),t=0;t<i.length;t++)r=s(i[t]),n=o(r),n&&n.id&&l.push(n.id)},oi=function(){if(i){var n=i.querySelectorAll(".dgControl_list");n&&n.length!==0&&n.forEach(function(n){var t=Array.from(n.children).filter(function(n){return n.tagName==="LI"});t.length!==0&&t.forEach(function(n){n.hasAttribute("aria-setsize")||n.setAttribute("aria-setsize","1");n.hasAttribute("aria-posinset")||n.setAttribute("aria-posinset","1")})})}};si()})(ImgFdPage||(ImgFdPage={}))