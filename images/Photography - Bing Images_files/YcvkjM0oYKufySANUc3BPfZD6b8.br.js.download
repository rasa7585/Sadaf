var OverFlowMenu;(function(){function yt(r,f){var l;if(t){if(n&&n===u.getImageItemWrapper(r)){e();return}if(n=u.getImageItemWrapper(r),n){a&&(n.classList.contains("crpttl")?(a.classList.remove(it),l=_qs(tt,n),a.href=l===null||l===void 0?void 0:l.getAttribute("href")):a.classList.add(it));var s=r.getBoundingClientRect(),w=_d.documentElement.clientWidth-s.right>i.MenuRightSideMargin,b=_d.documentElement.clientHeight-s.bottom>i.MenuBottomSideMargin,v="initial",c="px",y=5;b?(t.style.bottom=v,t.style.top=_w.scrollY+s.bottom+5+c):(t.style.top=v,t.style.bottom=_w.innerHeight-s.top-_w.scrollY-10+c);w?(t.style.right=v,t.style.left=_w.scrollX+s.left+c):(t.style.left=v,t.style.right=_w.innerWidth-s.right-_w.scrollX-15+c);t.classList.remove(h);var p=t.getBoundingClientRect(),k=p.right,d=p.left;k>_w.innerWidth&&(t.style.right=y+c);d<0&&(t.style.left=y+c);r.setAttribute(nt,"true");o&&f&&f.evtType&&f.evtType===lt&&o.focus()}}}function pt(){var i,t,r;n&&(i=u.processElement(n),t=u.tryParseJson(i.length>0?i[0]:null),t)&&(r={itemId:t.id||"",mid:t.mid||"",turl:t.turl||"",surl:t.purl||"",maw:t.tw||0,mah:t.th||0,imgurl:t.murl||"",entrypoint:"Image.Feed"},typeof EditorialToolTabs!="undefined"?(EditorialToolTabs.setupInternalMetaData("",!0,!0,r),EditorialToolTabs.imageClick(),s=_ge("adult_mm_mark_element")):typeof FlagFeedback!="undefined"&&FlagFeedback&&(FlagFeedback.metadata=r,FlagFeedback.c(),s=_ge("fbdialog_container")),e())}function wt(){if(r)try{var n=r.getBoundingClientRect(),t=(_w.innerHeight-n.height)*.95;r.style.top=t+"px";r.style.right="calc(50% - ".concat(n.width/2,"px)")}catch(i){return null}}function v(n){n?(r.classList.remove(i.ParentDislikedViewClass,h),r.classList.add(i.ClonedDislikedViewClass,i.DialogDislikedViewClass),wt()):(r.classList.add(i.ParentDislikedViewClass,h),r.classList.remove(i.ClonedDislikedViewClass,i.DialogDislikedViewClass),f=null,clearTimeout(c),c=null)}function bt(){n&&(u.processRequest("Dislike",u.processElement(n)),r)&&(f=n,v(!0),n.parentElement&&(n.parentElement.style.display="none"),ft(),et(),sj_be(r,ct,ft),sj_be(r,ht,et),n.classList.add(i.DislikedImagesClass),n.classList.remove(p),e())}function rt(){var r,t,i;n&&(t=kt(),t)&&(i=_qs(ot,t),i)&&(i.textContent=(r=i.dataset)===null||r===void 0?void 0:r.rptimg,n.classList.add(st),n.classList.remove(p),n.appendChild(t),t.classList.remove(h),s.getAttribute("data-dislikere")=="true"&&u.processRequest("Dislike",u.processElement(n)),e())}function kt(){var n=r===null||r===void 0?void 0:r.cloneNode(!0);return n?(n.classList.remove(i.ParentDislikedViewClass),n.classList.add(i.ClonedDislikedViewClass),n):null}function dt(){f&&(u.processRequest("Undislike",u.processElement(f)),f.classList.remove(i.DislikedImagesClass),f.classList.add(p),f.parentElement&&(f.parentElement.style.display="block"),v(!1))}function e(){var i;t===null||t===void 0?void 0:t.classList.add(h);n&&((i=_qs(k,n))===null||i===void 0?void 0:i.setAttribute(nt,"false"),n=null)}function gt(t){var i,r;t.code==="Escape"&&((i=_qs(k,n))===null||i===void 0?void 0:i.focus(),e());t.code==="Tab"&&(r=sj_et(t),r==o&&t.shiftKey&&(sj_pd(t),l===null||l===void 0?void 0:l.focus()),r==l&&(sj_pd(t),o===null||o===void 0?void 0:o.focus()))}function ni(i){var r=sj_et(i),u=t==r||(t===null||t===void 0?void 0:t.contains(r)),f=s===null||s===void 0?void 0:s.contains(r),o=r===null||r===void 0?void 0:r.getAttribute("href");u||f||o===b||n&&e()}function ut(){n===null||n===void 0?void 0:n.focus();e()}function ft(){c!=null&&clearTimeout(c)}function et(){c=setTimeout(function(){v(!1)},vt)}function ri(n){if(n&&n[1]){var i=n[1];i.bind("Dislike",bt,!0);i.bind("dtmnu",yt,!0);i.bind("Report",pt,!0);i.bind("UndoDislike",dt,!0);i.bind("fdrefresh",ii,!0);i.bind("CloseDislike",function(){v(!1);typeof mmLog!="undefined"&&mmLog('{"T":"CI.Click","Name":"FeedPage","Txt":"DislikeDialog","ClickSrc":"Close","TS":'+sb_gt()+"}")},!0);sj_be(t,"keydown",gt)}}function ui(){sj_evt.unbind(d,ut);sj_evt.unbind(g,rt)}var y,u=ImageFeedUtils,i=FeedConstants,t=(y=_qs(i.ImageItemMenuSelector))!==null&&y!==void 0?y:undefined,ot=".fdshl_s",p="isv",w="a.fddtmnu-row",o=_qs(w,t),l=_qs("".concat(w,":last-of-type"),t),r=_qs(".".concat(i.ParentDislikedViewClass)),st="imgrptd",ht="mouseleave",ct="mouseenter",lt="keydown",h="fdhide",b="#CA!dtmnu",k=".infact> a[href='".concat(b,"']"),d="flagfeedback_close",g="flagfeedback_submit",at="focusin",nt="aria-expanded",vt=5e3,s,n=null,f=null,c=null,tt="a.comments,a.comment",a=_qs(tt,t),it="hd",ti=function(n){sj_sp(n)},ii=function(){_w.location.reload()},fi=function(){sj_evt.bind("ClientLinkAction_Loaded",ri,!0);sj_evt.bind(d,ut,!0);sj_evt.bind(g,rt,!0);sj_evt.bind("prismFocusChange",e,!0);sj_be(t,at,ti);sj_be(_w,"beforeunload",ui);sj_be(sj_b,i.ClickEventName,ni)};fi()})(OverFlowMenu||(OverFlowMenu={}))